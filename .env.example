# =============================================================================
# Academic Data Collection API - Environment Configuration
# =============================================================================
# Copy this file to .env and configure for your environment
# DO NOT commit .env to version control!

# =============================================================================
# Application Settings
# =============================================================================

# Environment (development, staging, production)
ENV=development

# Server port
PORT=8080

# Server host (0.0.0.0 for Docker, localhost for local dev)
HOST=0.0.0.0

# API version prefix (e.g., /api/v1)
API_VERSION=v1

# Application name (used in logs)
APP_NAME=academic-api

# =============================================================================
# Database Configuration
# =============================================================================

# SQLite database file path
DB_PATH=./data/academic_data.db

# Database connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=300  # seconds

# Enable foreign key constraints (recommended: true)
DB_FOREIGN_KEYS=true

# Enable WAL mode for better concurrency (recommended: true)
DB_WAL_MODE=true

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level (debug, info, warn, error)
LOG_LEVEL=debug

# Log format (json, text)
LOG_FORMAT=text

# Log output (stdout, file, both)
LOG_OUTPUT=stdout

# Log file path (if LOG_OUTPUT is file or both)
LOG_FILE=./logs/app.log

# Enable request logging
LOG_REQUESTS=true

# =============================================================================
# API Configuration
# =============================================================================

# Enable CORS
CORS_ENABLED=true

# CORS allowed origins (comma-separated, * for all)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080

# CORS allowed methods
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS

# CORS allowed headers
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# CORS allow credentials
CORS_ALLOW_CREDENTIALS=true

# Request timeout (seconds)
REQUEST_TIMEOUT=30

# Max request body size (bytes, 10MB default)
MAX_BODY_SIZE=10485760

# =============================================================================
# Pagination Defaults
# =============================================================================

# Default page size for list endpoints
DEFAULT_PAGE_SIZE=50

# Maximum page size allowed
MAX_PAGE_SIZE=100

# =============================================================================
# Rate Limiting (Future Implementation)
# =============================================================================

# Enable rate limiting
RATE_LIMIT_ENABLED=false

# Requests per minute per IP
RATE_LIMIT_REQUESTS=60

# Rate limit window (minutes)
RATE_LIMIT_WINDOW=1

# =============================================================================
# Authentication & Security (Future Implementation)
# =============================================================================

# Enable API key authentication
AUTH_ENABLED=false

# JWT secret key (generate with: openssl rand -base64 32)
JWT_SECRET=your-secret-key-here-change-in-production

# JWT token expiration (hours)
JWT_EXPIRATION=24

# API keys (comma-separated, format: name:key)
API_KEYS=scraper:your-scraper-api-key,admin:your-admin-api-key

# Enable HTTPS redirect
FORCE_HTTPS=false

# =============================================================================
# Data Collection Settings
# =============================================================================

# Default academic year for reports
DEFAULT_ACADEMIC_YEAR=2024

# Data collection user identifier (for tracking)
COLLECTOR_ID=default-collector

# Scraper timeout (seconds)
SCRAPER_TIMEOUT=60

# Scraper retry attempts
SCRAPER_RETRY_ATTEMPTS=3

# Scraper user agent
SCRAPER_USER_AGENT=Academic-Data-Collector/1.0

# =============================================================================
# Export Configuration
# =============================================================================

# CSV export encoding (utf-8, iso-8859-1)
CSV_ENCODING=utf-8

# CSV delimiter
CSV_DELIMITER=,

# Include headers in CSV export
CSV_INCLUDE_HEADERS=true

# Temporary export directory
EXPORT_DIR=./tmp/exports

# Export file retention (hours, 0 for no cleanup)
EXPORT_RETENTION=24

# =============================================================================
# Backup Configuration
# =============================================================================

# Automatic backup enabled
AUTO_BACKUP_ENABLED=false

# Backup schedule (cron format, daily at 2 AM)
BACKUP_SCHEDULE=0 2 * * *

# Backup retention days
BACKUP_RETENTION_DAYS=30

# Backup directory
BACKUP_DIR=./backups

# =============================================================================
# External Services (Future Integration)
# =============================================================================

# Email notifications (for alerts)
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@academic-api.com

# Webhook URL for data collection notifications
WEBHOOK_URL=

# Slack webhook for alerts (optional)
SLACK_WEBHOOK_URL=

# =============================================================================
# Monitoring & Observability (Future Implementation)
# =============================================================================

# Enable metrics endpoint
METRICS_ENABLED=false

# Metrics port (separate from main API)
METRICS_PORT=9090

# Enable health check endpoint
HEALTH_CHECK_ENABLED=true

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# =============================================================================
# Development Settings
# =============================================================================

# Enable debug mode (verbose logging, detailed errors)
DEBUG=true

# Enable hot reload (if using air)
HOT_RELOAD=true

# Enable SQL query logging
LOG_SQL_QUERIES=true

# Enable profiling endpoint (DO NOT enable in production)
PROFILING_ENABLED=false

# Mock external services for testing
MOCK_EXTERNAL_SERVICES=false

# =============================================================================
# Feature Flags
# =============================================================================

# Enable experimental features
EXPERIMENTAL_FEATURES=false

# Enable bulk import endpoint
FEATURE_BULK_IMPORT=true

# Enable CSV export
FEATURE_CSV_EXPORT=true

# Enable data validation
FEATURE_DATA_VALIDATION=true

# Enable collection progress tracking
FEATURE_PROGRESS_TRACKING=true

# =============================================================================
# State-Specific Scraper Settings
# =============================================================================

# California data portal credentials (if required)
CA_PORTAL_USERNAME=
CA_PORTAL_PASSWORD=

# Texas data portal API key (if required)
TX_PORTAL_API_KEY=

# New York data portal credentials (if required)
NY_PORTAL_USERNAME=
NY_PORTAL_PASSWORD=

# Generic state portal timeout (seconds)
STATE_PORTAL_TIMEOUT=30

# =============================================================================
# Performance Settings
# =============================================================================

# Enable response compression (gzip)
COMPRESSION_ENABLED=true

# Cache TTL for reports (seconds, 0 to disable)
CACHE_TTL=300

# Worker pool size for async operations
WORKER_POOL_SIZE=5

# Enable query result caching
QUERY_CACHE_ENABLED=false

# =============================================================================
# Testing Settings (for test environment only)
# =============================================================================

# Use in-memory database for tests
TEST_DB_IN_MEMORY=true

# Test database path
TEST_DB_PATH=./data/test.db

# Reset database before each test
TEST_DB_RESET=true

# =============================================================================
# Docker-Specific Settings
# =============================================================================

# Container timezone
TZ=America/New_York

# Enable container health checks
HEALTH_CHECK_INTERVAL=30

# Container restart policy (no, on-failure, always, unless-stopped)
RESTART_POLICY=unless-stopped

# =============================================================================
# Migration Settings
# =============================================================================

# Migrations directory
MIGRATIONS_DIR=./migrations

# Auto-run migrations on startup (useful for Docker)
AUTO_MIGRATE=true

# Migration lock timeout (seconds)
MIGRATION_LOCK_TIMEOUT=10

# =============================================================================
# Notes
# =============================================================================
# 
# Production Checklist:
# 1. Set ENV=production
# 2. Change JWT_SECRET to a strong random value
# 3. Update API_KEYS with secure keys
# 4. Set DEBUG=false
# 5. Set LOG_LEVEL=info or warn
# 6. Enable FORCE_HTTPS=true if behind SSL
# 7. Configure proper CORS_ALLOWED_ORIGINS
# 8. Set AUTO_BACKUP_ENABLED=true
# 9. Configure SENTRY_DSN for error tracking
# 10. Review and secure all credentials
#
# Security Notes:
# - Never commit .env to version control
# - Rotate API keys regularly
# - Use strong, unique passwords
# - Keep JWT_SECRET secure and random
# - Review CORS settings for production
# - Enable rate limiting in production
#
# Performance Tips:
# - Enable COMPRESSION_ENABLED for large responses
# - Set appropriate CACHE_TTL for reports
# - Tune DB_MAX_OPEN_CONNS based on load
# - Enable DB_WAL_MODE for better concurrency
# - Monitor LOG_LEVEL impact on performance
#
# =============================================================================
